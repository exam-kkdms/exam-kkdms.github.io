<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Teacher Paper Verification</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#667eea,#764ba2);
  min-height:100vh;margin:0;
  display:flex;justify-content:center;align-items:center;
}
.card{
  background:#fff;width:95%;max-width:520px;
  padding:25px;border-radius:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.2);
}
h2{text-align:center;margin-bottom:20px}
label{font-weight:600;margin-top:12px;display:block}
select,input,textarea{
  width:100%;padding:10px;margin-top:6px;
  border-radius:8px;border:1px solid #ccc;
}
button{
  width:100%;margin-top:20px;padding:12px;
  background:#667eea;color:#fff;border:none;
  border-radius:8px;font-size:16px;cursor:pointer;
}
button:disabled{background:#aaa;cursor:not-allowed}
.paper{
  border:1px solid #ddd;padding:12px;
  border-radius:10px;margin-top:12px;
}
.remark{display:none;margin-top:8px}
.spinner{
  display:none;margin:20px auto;width:40px;height:40px;
  border:4px solid #ddd;border-top:4px solid #667eea;
  border-radius:50%;animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* Beautiful alert */
.alert{
  display:none;
  background:#48bb78;
  color:white;
  padding:15px;
  border-radius:10px;
  text-align:center;
  font-weight:600;
  margin-top:20px;
}
</style>
</head>

<body>
<div class="card">

<h2>Teacher Login</h2>

<label>Teacher Name</label>
<select id="teacher">
  <option value="">-- Select Teacher --</option>
  <option>MAYURI SINGHA ROY</option>
  <option>HABIBA KHATUN</option>
  <option>SOUMI GHOSH</option>
  <option>SONAMOTI MAHATO</option>
  <option>SUCHANDA SAHA</option>
  <option>MOU DAS</option>
  <option>SATABDI SINGHA ROY</option>
  <option>PRITHA ADHIKARI</option>
  <option>SHELLY CHATTERJEE</option>
  <option>SUDIPTA MONIA</option>
  <option>PRAKRITI TAMANG</option>
  <option>NILANJANA PAL</option>
  <option>MOHUWA RANI SARKAR</option>
  <option>SUNITA PAL</option>
  <option>MADHUMITA SINGHA</option>
  <option>MOUMITA GHOSH</option>
  <option>MOUMITA KAR RUDRA</option>
  <option>ABHISHEK SARKAR</option>
  <option>SOUMEN DHAR</option>
  <option>SAYAN DEY</option>
  <option>SURAJ DAS</option>
  <option>GIMI DAS</option>
  <option>DANIEL HAMBRAM</option>
  <option>KUSHAL CHETRI</option>
  <option>SUPRIYA CHKRABORTY</option>
  <option>YADAB CHANDRA</option>
  <option>BIKRAM SINGH</option>
  <option>NURJAHAN KHATUN</option>
  <option>NABENDU PAUL</option>
  <option>PREMADITYA MUKHERJEE</option>
  <option>ABDUL HASAN SK</option>
</select>

<label>Password</label>
<div style="position:relative;">
  <input type="password" id="password" placeholder="Enter password" style="padding-right:45px;">
  
  <span onclick="togglePassword()"
    style="
      position:absolute;
      right:12px;
      top:50%;
      transform:translateY(-50%);
      cursor:pointer;
      font-size:18px;
      z-index:5;
    "
    id="eye">üëÅÔ∏è</span>
</div>


<button onclick="login()">Login</button>

<div class="spinner" id="loginSpinner"></div>

<form id="reviewForm" style="display:none">
  <div id="papers"></div>

  <label style="margin-top:15px">
    <input type="checkbox" id="declare">
    I declare that I have checked all papers.
  </label>

  <button id="submitBtn" type="button" onclick="submitForm()">Submit</button>
  <div class="spinner" id="submitSpinner"></div>
</form>

<div class="alert" id="successAlert">‚úÖ Form submitted successfully</div>

</div>

<script>
const LOGIN_API="https://script.google.com/macros/s/AKfycbz7h8VIv4-zWmunjZLjliIDtVgrzxFVijbW1Iu4Z2YamlWtqbXYloc2e1WL9AiQq0ehZQ/exec";
const SUBMIT_API="https://script.google.com/macros/s/AKfycbynoy7cKWELrystQxXu4zwVAPPPFdpMrPYmy0AxutgelaejOkmJPReo-FXGGo_pOJzivg/exec";

let paperData=[],submitted=false;

function login(){
  loginSpinner.style.display="block";
  fetch(`${LOGIN_API}?teacher=${teacher.value}`)
  .then(r=>r.json())
  .then(j=>{
    loginSpinner.style.display="none";
    if(j.data[0].PASSWORD!==password.value){alert("Wrong password");return;}
    paperData=j.data;
    reviewForm.style.display="block";
    renderPapers();
  });
}

function renderPapers(){
  papers.innerHTML="";
  paperData.forEach((p,i)=>{
    papers.innerHTML+=`
      <div class="paper">
        <b>${p.CLASS} - ${p.SUBJECT}</b><br>
        <label><input type="radio" name="s${i}" value="OK" checked> OK</label>
        <label><input type="radio" name="s${i}" value="NOT OK" onclick="showRemark(${i})"> NOT OK</label>
        <textarea id="r${i}" class="remark" placeholder="Mandatory remark"></textarea>
      </div>`;
  });
}

function showRemark(i){
  document.getElementById("r"+i).style.display="block";
}

function submitForm(){
  if(submitted) return;
  if(!declare.checked){alert("Please accept declaration");return;}

  let payload=[];
  for(let i=0;i<paperData.length;i++){
    let status=document.querySelector(`input[name="s${i}"]:checked`).value;
    let remark=document.getElementById("r"+i).value;
    if(status==="NOT OK" && remark===""){alert("Remark required");return;}
    payload.push({
      teacher:teacher.value,
      class:paperData[i].CLASS,
      subject:paperData[i].SUBJECT,
      status,remark
    });
  }

  submitted=true;
  submitBtn.disabled=true;
  submitSpinner.style.display="block";

  fetch(SUBMIT_API,{method:"POST",body:JSON.stringify(payload)})
  .then(()=>{
    submitSpinner.style.display="none";
    successAlert.style.display="block";
    reviewForm.reset();
    papers.innerHTML="";
  });
}
  function togglePassword() {
  const pwd = document.getElementById("password");
  const eye = document.getElementById("eye");

  if (pwd.type === "password") {
    pwd.type = "text";
    eye.textContent = "üôà";
  } else {
    pwd.type = "password";
    eye.textContent = "üëÅÔ∏è";
  }
}
</script>
</body>
</html>
